<div>
  <ul class="nav nav-tabs nav-justified" role="tablist" id='resource-tabs'>
    <li role="presentation" class="active">
      <a href="#graph" aria-controls="graph" role="tab" data-toggle="tab">Graph</a>
    </li>
    <li role="presentation">
      <a href="#distribution" aria-controls="distribution" role="tab" data-toggle="tab">Distribution</a>
    </li>
    <li role="presentation">
      <a href="#connections" class='trigger-label-load' aria-controls="connections" role="tab" data-toggle="tab">Connections</a>
    </li>
    <li role="presentation">
      <a href="#keywords" aria-controls="keywords" role="tab" data-toggle="tab">Keywords</a>
    </li>
    <li role="presentation">
      <a href="#data" aria-controls="data" role="tab" data-toggle="tab">Data</a>
    </li>
  </ul>

    <div class="tab-content">
      <div role="tabpanel" class="tab-pane active" id="graph">

        <p id='graph-for' class='lead text-center' data-uri-for-graph='<%= @presenter.resource_uri %>'>
          Visual representation of weighted connections for <%= @presenter.title %>
        </p>
        <p class='small' id='graph-legend'>
          This graph shows connections for this Person. Their connections have been ranked, and the connections with the smallest number of exchanged emails discarded below a set threshold. At each step from the Person that generated this graph, this threshold is increased, so that only comparatively more important connections (in terms of emails exchanged) are visualised as links from People (nodes) that are further removed from the Person that generated this graph. The thickness of edges is indicative of the number of emails exchanged.
        </p>
        <div id='graph-vis'>
          <div id='graph-loading-placeholder'>
            </p><em>Loading, please be patient...</em></p>
            <%= image_tag 'loading.gif', width: 60, height: 60 %>
          </div>
        </div>

      </div>

      <div role="tabpanel" class="tab-pane" id="distribution">

      </div>

      <div role="tabpanel" class="tab-pane" id="connections">

        <p class='lead text-center'>This Person has <%= @presenter.connections_length %> known connections.</p>
        <p class='text-center'>
          <small>To recalculate, click below and refresh the page in a few minutes to see the results.</small>
          <br><br>
          <a href='#' class='btn btn-primary' data-uri='<%= @presenter.resource_uri %>' id='recalculate-connections'>
            Recalculate and write connections
          </a>
        </p>

        <table class='table table-striped'>
          <thead>
            <th>URI</th>
            <th>Emails Exchanged</th>
          </thead>
          <tbody>
            <% @presenter.weighted_connections.each do |connection| %>
              <tr>
                <td>
                  <a class='ajax-label' data-uri="<%= connection[0] %>" href="<%= URI(connection[0]).path %>">
                    <%= connection[0] %>
                  </a>
                </td>
                <td><%= connection[1] %></td>
              </tr>
            <% end %>
          </tbody>
        </table>

      </div>

      <div role="tabpanel" class="tab-pane" id="keywords">

        <table class='table table-striped'>
          <thead>
            <th>Keyword</th>
            <th>Mentions</th>
          </thead>
          <tbody>
            <% @presenter.keywords.each do |kw| %>
              <tr>
                <td><a href="/id/keywords/keyword/<%= kw[0].downcase %>"><%= kw[0] %></a></td>
                <td><%= kw[1] %></td>
              </tr>
            <% end %>
          </tbody>
        </table>

      </div>

      <div role="tabpanel" class="tab-pane" id="data">

        <table class='table table-striped'>
          <thead>
            <th>Description</th>
            <th>URI</th>
            <th>Object</th>
          </thead>
          <tbody>
            <% @presenter.fields.each do |field| %>

              <% if !field[2].nil? && !field[2].blank? %>
                <tr>
                  <td><%= field[0] %></td>
                  <td><%= field[1] %></td>
                  <td><%= "#{field[2]}".html_safe %></td>
                </tr>
              <% end %>

            <% end %>
          </tbody>
        </table>

      </div>
    </div>
  </div>
</div>